---
layout: post
title:  "設定ファイルの管理"
categories: conf manage
---
VM で複数の Linux を動かしている。設定はほぼ同じなのだが、「ほぼ」が難しい

この項は順次追記していく

* TOC
{:toc}

# 環境
VM で Linux が幾つかある。もちろん同じ物では無い。ディストリビューションが
違ったり、特定のアプリケーションを使うのが目的だったり。あるいは Linux 以外の
OS を動かしたり。

ただ、通常使うアプリケーションは大体決まっている。シェルやエディタなんかは
むしろ、環境が変わっても同じ設定にしておかないと使いにくい。



# 方針

- 設定ファイルは分散管理を使う。
- 個々の環境の差異は環境を識別するスクリプトを作成する
- リポジトリの同期と設定スクリプトで手間を最小にする


# 分散管理
検討した結果、Mercurial を使う事にした。

分散管理としては git が有名だが、git は共用リポジトリは共用として
作成する事になる様だった。

Mercurial は単に作成したリポジトリを共用リポジトリとすることができた。

手順は以下の様になる。

hostA で以下を実行する

````
$ cd conf_directory
$ hg init
$ hg add *
$ hg commit -m "メッセージ"
````

他のホストで設定をコピーし、変更後、元ホストに反映する

````
$ hg clone ssh://hostA:conf_directory
$ cd conf_directory
（作業～ファイル更新）
$ hg commit -m "メッセージ"
$ hg push
````

他の（同じ）ホストで変更を追加し、元ホストに反映する

````
$ cd conf_directory
$ hg pull
（作業～ファイル更新）
$ hg commit -m "メッセージ"
$ hg push
````

まぁ、作業手順は git でも変わらない



# 環境の識別
コマンド、設定ファイルで環境を識別する



# 環境設定スクリプト

基本的にリポジトリに対してシンボリックリンクを張る。

共通の設定は共通設定へ。個別設定はリポジトリ中の個別設定へリンクを向ける。

